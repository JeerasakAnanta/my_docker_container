# qdrant
# date: 15-04-2024
# ref install: https://qdrant.tech/documentation/guides/installation

version: "3.8"

services:
  qdrant:
    image: qdrant/qdrant:latest
    container_name: qdrant_container
    restart: always
    ports:
      - "6333:6333" # HTTP / REST API
      - "6334:6334" # gRPC (if used)
    configs:
      - source: qdrant_config
        target: /qdrant/config/production.yaml
    volumes:
      # Bind mount to local folder (keeps data in ./qdrant_data)
      - ./qdrant_data:/qdrant/storage
      # Alternatively use the named volume below (uncomment to enable)
      # - qdrant_data:/qdrant/storage
    healthcheck:
      test: ["CMD-SHELL", "curl -sfS http://localhost:6333/collections || exit 1"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s
    networks:
      - qdrant_net

volumes:
  # Uncomment to persist data using a named Docker volume instead of a host bind
  qdrant_data:
    name: qdrant_data

networks:
  qdrant_net:
    driver: bridge